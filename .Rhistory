87, 43, 59
)
dat3 = data.frame(city, CaseNumber)
dat3$city = as.character(dat3$city)
sum_tab = dat3 %>%
group_by(city) %>%
summarise(m_i = n(),
Mean = mean(CaseNumber),
Std_dev = sd(CaseNumber))
sum_tab
pacman::p_load(tidyverse)
pacman::p_load(tidyverse)
city = c(rep(1, 10), rep(2, 4), rep(3, 7),
rep(4, 8), rep(5, 2), rep(6, 3))
CaseNumber = c(
146, 180, 251, 152, 72, 181, 171, 361, 73, 186,
99, 101, 52, 121,
199, 179, 98, 63, 126, 87, 62,
226, 129, 57, 46, 86, 43, 85, 165,
12, 23,
87, 43, 59
)
dat3 = data.frame(city, CaseNumber)
dat3$city = as.character(dat3$city)
sum_tab = dat3 %>%
group_by(city) %>%
summarise(m_i = n(),
Mean = mean(CaseNumber),
Std_dev = sd(CaseNumber))
sum_tab
tau_hat = N/n*sum(M_i*y_bar)
M_i = c(52, 19, 37, 39, 8, 14)
M = sum(M_i)
N = 45
n = nrow(sum_tab)
M_hat = N/n*sum(M_i)
y_bar = sum_tab$Mean
tau_hat = N/n*sum(M_i*y_bar)
mu_hat = N/n*sum(M_i*y_bar)/M_hat
m_i = sum_tab$m_i
sum_tab = dat3 %>%
group_by(city) %>%
summarise(m_i = n(),
Mean = mean(CaseNumber),
Std_dev = sd(CaseNumber),
Sum = sum(CaseNumber))
M_i/m_i
sum_tab$Sum
M_i/m_i*sum_tab$Sum
373*4.75
5.2*1773
dat3
sum_tab
sum_tab %>%
select(city, Mean) %>%
right_join(dat3)
sum_tab %>%
select(city, Mean) %>%
right_join(dat3) %>%
mutate(diff_square = (CaseNumber - Mean)^2) %>%
group_by(city) %>%
summarise(sum_square = sum(diff_square))
sum_square = sum_tab %>%
select(city, Mean) %>%
right_join(dat3) %>%
mutate(diff_square = (CaseNumber - Mean)^2) %>%
group_by(city) %>%
summarise(sum_square = sum(diff_square)) %>%
pull(sum_square)
s_i_square = 1/(m_i - 1)*sum_square
s_i_square
m_i
y_bar
s_r_square = sum((M_i*y_bar - M_i*mu_hat)^2)
s_r_square
N/(M^2*n)*sum((1 - m_i/M_i)*M_i^2*s_i_square/m_i)
N^2/M^2(1 - n/N)*s_r_square/n
N^2/M^2*(1 - n/N)*s_r_square/n
N^2/M^2*(1 - n/N)*s_r_square/n +
N/(M^2*n)*sum((1 - m_i/M_i)*M_i^2*s_i_square/m_i)
sd_tau = sqrt(V_tau)
sd_tau
V_tau = N^2/M^2*(1 - n/N)*s_r_square/n +
N/(M^2*n)*sum((1 - m_i/M_i)*M_i^2*s_i_square/m_i)
sd_tau = sqrt(V_tau)
sd_tau
V_tau = N^2*(1 - n/N)*s_t_square/n + N/n*sum((1 - m_i/M_i)*M_i^2*s_i_square/m_i)
s_t_square = 1/(n - 1)*sum(tau_i - tau_hat/n)^2
tau_i = M_i/m_i*sum_tab$Sum
s_t_square = 1/(n - 1)*sum(tau_i - tau_hat/n)^2
sum_square = sum_tab %>%
select(city, Mean) %>%
right_join(dat3) %>%
mutate(diff_square = (CaseNumber - Mean)^2) %>%
group_by(city) %>%
summarise(sum_square = sum(diff_square)) %>%
pull(sum_square)
s_i_square = 1/(m_i - 1)*sum_square
V_tau = N^2*(1 - n/N)*s_t_square/n + N/n*sum((1 - m_i/M_i)*M_i^2*s_i_square/m_i)
sd_tau = sqrt(V_tau)
sd_tau
tau_hat
tau_i = M_i/m_i*sum_tab$Sum
s_t_square = 1/(n - 1)*sum(tau_i - tau_hat/n)^2
sum_square = sum_tab %>%
select(city, Mean) %>%
right_join(dat3) %>%
mutate(diff_square = (CaseNumber - Mean)^2) %>%
group_by(city) %>%
summarise(sum_square = sum(diff_square)) %>%
pull(sum_square)
s_i_square = 1/(m_i - 1)*sum_square
V_tau = N^2*(1 - n/N)*s_t_square/n + N/n*sum((1 - m_i/M_i)*M_i^2*s_i_square/m_i)
sd_tau = sqrt(V_tau)
# V_mu
s_r_square = sum((M_i*y_bar - M_i*mu_hat)^2)
V_mu = N^2/M^2*(1 - n/N)*s_r_square/n +
N/(M^2*n)*sum((1 - m_i/M_i)*M_i^2*s_i_square/m_i)
sd_mu = sqrt(V_tau)
knitr::opts_chunk$set(echo = TRUE, fig.align='center', fig.width=6, fig.asp=0.618,fig.pos = 'H')
knitr::kable(
sum_tab, align = 'center',
caption = 'Summary statistics for each cluster',
digits = 2)
city = c(rep(1, 10), rep(2, 4), rep(3, 7),
rep(4, 8), rep(5, 2), rep(6, 3))
CaseNumber = c(
146, 180, 251, 152, 72, 181, 171, 361, 73, 186,
99, 101, 52, 121,
199, 179, 98, 63, 126, 87, 62,
226, 129, 57, 46, 86, 43, 85, 165,
12, 23,
87, 43, 59
)
dat3 = data.frame(city, CaseNumber)
dat3$city = as.character(dat3$city)
sum_tab = dat3 %>%
group_by(city) %>%
summarise(m_i = n(),
Mean = mean(CaseNumber),
Std_dev = sd(CaseNumber),
Sum = sum(CaseNumber))
pacman:p_load(tidyverse)
pacman::p_load(tidyverse)
city = c(rep(1, 10), rep(2, 4), rep(3, 7),
rep(4, 8), rep(5, 2), rep(6, 3))
CaseNumber = c(
146, 180, 251, 152, 72, 181, 171, 361, 73, 186,
99, 101, 52, 121,
199, 179, 98, 63, 126, 87, 62,
226, 129, 57, 46, 86, 43, 85, 165,
12, 23,
87, 43, 59
)
dat3 = data.frame(city, CaseNumber)
dat3$city = as.character(dat3$city)
sum_tab = dat3 %>%
group_by(city) %>%
summarise(m_i = n(),
Mean = mean(CaseNumber),
Std_dev = sd(CaseNumber),
Sum = sum(CaseNumber))
M_i = c(52, 19, 37, 39, 8, 14)
m_i = sum_tab$m_i
M = sum(M_i)
N = 45
n = nrow(sum_tab)
M_hat = N/n*sum(M_i)
y_bar = sum_tab$Mean
tau_hat = N/n*sum(M_i*y_bar)
mu_hat = N/n*sum(M_i*y_bar)/M_hat
M_i = c(52, 19, 37, 39, 8, 14)
m_i = sum_tab$m_i
M = sum(M_i)
N = 45
n = nrow(sum_tab)
M_hat = N/n*sum(M_i)
y_bar = sum_tab$Mean
tau_hat = N/n*sum(M_i*y_bar)
mu_hat = N/n*sum(M_i*y_bar)/M_hat
M_hat
mean(M_i)
y_bar
n
tau_i = M_i/m_i*sum_tab$Sum
s_t_square = 1/(n - 1)*sum(tau_i - tau_hat/n)^2
s_t_square
tau_i = M_i/m_i*sum_tab$Sum
tau_i
tau_hat
s_t_square = 1/(n - 1)*sum((tau_i - tau_hat/N)^2)
s_t_square
tau_i = M_i/m_i*sum_tab$Sum
s_t_square = 1/(n - 1)*sum((tau_i - tau_hat/N)^2)
sum_square = sum_tab %>%
select(city, Mean) %>%
right_join(dat3) %>%
mutate(diff_square = (CaseNumber - Mean)^2) %>%
group_by(city) %>%
summarise(sum_square = sum(diff_square)) %>%
pull(sum_square)
s_i_square = 1/(m_i - 1)*sum_square
V_tau = N^2*(1 - n/N)*s_t_square/n + N/n*sum((1 - m_i/M_i)*M_i^2*s_i_square/m_i)
sd_tau = sqrt(V_tau)
# V_mu
s_r_square = sum((M_i*y_bar - M_i*mu_hat)^2)
V_mu = N^2/M^2*(1 - n/N)*s_r_square/n +
N/(M^2*n)*sum((1 - m_i/M_i)*M_i^2*s_i_square/m_i)
sd_mu = sqrt(V_mu)
sd_mu
tau_i = M_i/m_i*sum_tab$Sum
s_t_square = 1/(n - 1)*sum((tau_i - tau_hat/N)^2)
sum_square = sum_tab %>%
select(city, Mean) %>%
right_join(dat3) %>%
mutate(diff_square = (CaseNumber - Mean)^2) %>%
group_by(city) %>%
summarise(sum_square = sum(diff_square)) %>%
pull(sum_square)
s_i_square = 1/(m_i - 1)*sum_square
V_tau = N^2*(1 - n/N)*s_t_square/n + N/n*sum((1 - m_i/M_i)*M_i^2*s_i_square/m_i)
sd_tau = sqrt(V_tau)
# V_mu
s_r_square = sum((M_i*y_bar - M_i*mu_hat)^2)
V_mu = N^2/M^2*(1 - n/N)*s_r_square/n +
N/(M^2*n)*sum((1 - m_i/M_i)*M_i^2*s_i_square/m_i)
sd_mu = sqrt(V_mu)
sd_tau
s_i_square
# V_mu
s_r_square = sum((M_i*y_bar - M_i*mu_hat)^2)
s_r_square
M_hat
M
rm(list = ls())
pacman::p_load(tidyverse)
city = c(rep(1, 10), rep(2, 4), rep(3, 7),
rep(4, 8), rep(5, 2), rep(6, 3))
CaseNumber = c(
146, 180, 251, 152, 72, 181, 171, 361, 73, 186,
99, 101, 52, 121,
199, 179, 98, 63, 126, 87, 62,
226, 129, 57, 46, 86, 43, 85, 165,
12, 23,
87, 43, 59
)
dat3 = data.frame(city, CaseNumber)
dat3$city = as.character(dat3$city)
sum_tab = dat3 %>%
group_by(city) %>%
summarise(
m_i = n(),
Mean = mean(CaseNumber),
Std_dev = sd(CaseNumber),
Sum = sum(CaseNumber))
M_i = c(52, 19, 37, 39, 8, 14)
m_i = sum_tab$m_i
N = 45
n = nrow(sum_tab)
M_hat = N/n*sum(M_i)
y_bar = sum_tab$Mean
tau_hat = N/n*sum(M_i*y_bar)
mu_hat = N/n*sum(M_i*y_bar)/M_hat
tau_i = M_i/m_i*sum_tab$Sum
s_t_square = 1/(n - 1)*sum((tau_i - tau_hat/N)^2)
sum_square = sum_tab %>%
select(city, Mean) %>%
right_join(dat3) %>%
mutate(diff_square = (CaseNumber - Mean)^2) %>%
group_by(city) %>%
summarise(sum_square = sum(diff_square)) %>%
pull(sum_square)
s_i_square = 1/(m_i - 1)*sum_square
V_tau = N^2*(1 - n/N)*s_t_square/n + N/n*sum((1 - m_i/M_i)*M_i^2*s_i_square/m_i)
sd_tau = sqrt(V_tau)
# V_mu
s_r_square = sum((M_i*y_bar - M_i*mu_hat)^2)
V_mu = N^2/M_hat^2*(1 - n/N)*s_r_square/n +
N/(M^2*n)*sum((1 - m_i/M_i)*M_i^2*s_i_square/m_i)
V_mu = N^2/M_hat^2*(1 - n/N)*s_r_square/n +
N/(M_hat^2*n)*sum((1 - m_i/M_i)*M_i^2*s_i_square/m_i)
sd_mu = sqrt(V_mu)
V_mu
standard_error
N = 1132
n = length(Age)
Diameter = c(
12, 11.4, 7.9, 9, 10.5, 7.9, 7.3, 10.2, 11.7, 11.3,
5.7, 8.0, 10.3, 12, 9.2, 8.5, 7, 10.7, 9.3, 8.2)
Age = c(125, 119, 83, 85, 99, 117, 69, 133, 154, 168,
61, 80, 114, 147, 122, 106, 82, 88, 97, 99)
dat = data.frame(Diameter, Age)
N = 1132
n = length(Age)
tau_x = 10.3
Bhat = mean(Age)/mean(Diameter)
residual = Age - Bhat*Diameter
SSE = sum(residual^2)/(n-1)
VhatB = (1-n/N)*SSE*tau_x^2/(n*mean(Diameter)^2)
standard_error = sqrt(VhatB)
standard_error
M = c(44,33,26,22,76,63,20,44,54,34,46,24,46,100,15)
sample( 1:15 , size=5 , prob=M/sum(M) , replace=TRUE )
sample( 1:15 , size=5 , prob=M/sum(M) , replace=TRUE )
sample( 1:15 , size=5 , prob=M/sum(M) , replace=TRUE )
sample( 1:15 , size=5 , prob=M/sum(M) , replace=TRUE )
sample( 1:15 , size=5 , prob=M/sum(M) , replace=TRUE )
sample( M , size=5 , prob=M/sum(M) , replace=TRUE )
sample( M , size=5 , prob=M/sum(M) , replace=TRUE )
sample( M , size=5 , prob=M/sum(M) , replace=TRUE )
sample( M , size=5 , prob=M/sum(M) , replace=TRUE )
sample( M , size=5 , prob=M/sum(M) , replace=TRUE )
sample( M , size=5 , prob=M/sum(M) , replace=TRUE )
sample( M , size=5 , prob=M/sum(M) , replace=TRUE )
sample( M , size=5 , prob=M/sum(M) , replace=TRUE )
sample( M , size=5 , prob=M/sum(M) , replace=TRUE )
sample( M , size=5 , prob=M/sum(M) , replace=FALSE )
sample( M , size=5 , prob=M/sum(M) , replace=FALSE )
sample( M , size=5 , prob=M/sum(M) , replace=FALSE )
sample( M , size=5 , prob=M/sum(M) , replace=FALSE )
sample( M , size=5 , prob=M/sum(M) , replace=FALSE )
sample( M , size=5 , prob=M/sum(M) , replace=FALSE )
sample( M , size=5 , prob=M/sum(M) , replace=FALSE )
sample( M , size=5 , prob=M/sum(M) , replace=FALSE )
sample( M , size=5 , prob=M/sum(M) , replace=FALSE )
sample( M , size=5 , prob=M/sum(M) , replace=FALSE )
for (i in 1:10) sample( M , size=5 , prob=M/sum(M) , replace=FALSE )
for (i in 1:10) print(sample( M , size=5 , prob=M/sum(M) , replace=FALSE ))
N=45
n=6
Mi=c(52,19,37,39,8,14)
mi=c(10,4,7,8,2,3)
y1=c(146,180,251,152,72,181,171,361,73,186)
y2=c(99,101,52,121)
y3=c(199,179,98,63,126,87,62)
y4=c(226,129,57,46,86,43,85,165)
y5=c(12,23)
y6=c(87,43,59)
yij_1=sum(y1)
yij_2=sum(y2)
yij_3=sum(y3)
yij_4=sum(y4)
yij_5=sum(y5)
yij_6=sum(y6)
m1=10
m2=4
m3=7
m4=8
m5=2
m6=3
knitr::opts_chunk$set(echo = TRUE, fig.align='center', fig.width=6, fig.asp=0.618,fig.pos = 'H')
M_i = c(52, 19, 37, 39, 8, 14)
m_i = sum_tab$m_i
pacman::p_load(tidyverse)
city = c(rep(1, 10), rep(2, 4), rep(3, 7),
rep(4, 8), rep(5, 2), rep(6, 3))
CaseNumber = c(
146, 180, 251, 152, 72, 181, 171, 361, 73, 186,
99, 101, 52, 121,
199, 179, 98, 63, 126, 87, 62,
226, 129, 57, 46, 86, 43, 85, 165,
12, 23,
87, 43, 59
)
dat3 = data.frame(city, CaseNumber)
dat3$city = as.character(dat3$city)
sum_tab = dat3 %>%
group_by(city) %>%
summarise(
m_i = n(),
Mean = mean(CaseNumber),
Std_dev = sd(CaseNumber),
Sum = sum(CaseNumber))
M_i = c(52, 19, 37, 39, 8, 14)
m_i = sum_tab$m_i
N = 45
n = nrow(sum_tab)
M_hat = N/n*sum(M_i)
y_bar = sum_tab$Mean
tau_hat = N/n*sum(M_i*y_bar)
mu_hat = N/n*sum(M_i*y_bar)/M_hat
tau_hat
N=45
n=6
Mi=c(52,19,37,39,8,14)
mi=c(10,4,7,8,2,3)
y1=c(146,180,251,152,72,181,171,361,73,186)
y2=c(99,101,52,121)
y3=c(199,179,98,63,126,87,62)
y4=c(226,129,57,46,86,43,85,165)
y5=c(12,23)
y6=c(87,43,59)
yij_1=sum(y1)
yij_2=sum(y2)
yij_3=sum(y3)
yij_4=sum(y4)
yij_5=sum(y5)
yij_6=sum(y6)
m1=10
m2=4
m3=7
m4=8
m5=2
m6=3
tauhat = (N/n)*zig(Mi*ybari)
pacman::p_load(tidyverse)
city = c(rep(1, 10), rep(2, 4), rep(3, 7),
rep(4, 8), rep(5, 2), rep(6, 3))
CaseNumber = c(
146, 180, 251, 152, 72, 181, 171, 361, 73, 186,
99, 101, 52, 121,
199, 179, 98, 63, 126, 87, 62,
226, 129, 57, 46, 86, 43, 85, 165,
12, 23,
87, 43, 59
)
dat3 = data.frame(city, CaseNumber)
dat3$city = as.character(dat3$city)
sum_tab = dat3 %>%
group_by(city) %>%
summarise(
m_i = n(),
Mean = mean(CaseNumber),
Std_dev = sd(CaseNumber),
Sum = sum(CaseNumber))
M_i = c(52, 19, 37, 39, 8, 14)
m_i = sum_tab$m_i
N = 45
n = nrow(sum_tab)
M_hat = N/n*sum(M_i)
y_bar = sum_tab$Mean
tau_hat = N/n*sum(M_i*y_bar)
mu_hat = N/n*sum(M_i*y_bar)/M_hat
M_hat
tau_i = M_i/m_i*sum_tab$Sum
s_t_square = 1/(n - 1)*sum((tau_i - tau_hat/N)^2)
sum_square = sum_tab %>%
select(city, Mean) %>%
right_join(dat3) %>%
mutate(diff_square = (CaseNumber - Mean)^2) %>%
group_by(city) %>%
summarise(sum_square = sum(diff_square)) %>%
pull(sum_square)
s_i_square = 1/(m_i - 1)*sum_square
V_tau = N^2*(1 - n/N)*s_t_square/n + N/n*sum((1 - m_i/M_i)*M_i^2*s_i_square/m_i)
sd_tau = sqrt(V_tau)
# V_mu
s_r_square = sum((M_i*y_bar - M_i*mu_hat)^2)
V_mu = N^2/M_hat^2*(1 - n/N)*s_r_square/n +
N/(M_hat^2*n)*sum((1 - m_i/M_i)*M_i^2*s_i_square/m_i)
sd_mu = sqrt(V_mu)
s_r_square
s_r_square/n
N/(M_hat^2*n)*sum((1 - m_i/M_i)*M_i^2*s_i_square/m_i)
N^2/M_hat^2*(1 - n/N)*s_r_square/n
V_mu
sd_mu
1- (99/100)^100
1- (99/100)^1000
1- (99/100)^200
1- (99/100)^300
nstu = c(31, 29, 25, 35, 15, 31, 22, 27, 25, 19, 30, 18, 21,
40, 38, 28, 17, 22, 41, 32, 35, 19, 29, 18, 31)
scores = c(1590, 1510, 1490, 1610, 800, 1720, 1310, 1427, 1290,
860, 1620, 710, 1140, 1980, 1990, 1420, 900, 1080,
2010, 1740, 1750, 890, 1470, 910, 1740)
nstu
scores
N = 108
n = length(scores)
M_bar = sum(n_stu)/n
tau_hat = N/n*sum(scores)
mu_hat = tau_hat/(N*M_bar)
n_stu = c(31, 29, 25, 35, 15, 31, 22, 27, 25, 19, 30, 18, 21,
40, 38, 28, 17, 22, 41, 32, 35, 19, 29, 18, 31)
scores = c(1590, 1510, 1490, 1610, 800, 1720, 1310, 1427, 1290,
860, 1620, 710, 1140, 1980, 1990, 1420, 900, 1080,
2010, 1740, 1750, 890, 1470, 910, 1740)
N = 108
n = length(scores)
M_bar = sum(n_stu)/n
tau_hat = N/n*sum(scores)
mu_hat = tau_hat/(N*M_bar)
mu_hat
sum(scores)/sum(n_stu)
y_bar = scores/n_stu
N = 108
n = length(scores)
y_bar = scores/n_stu
M_bar = sum(n_stu)/n
tau_hat = N/n*sum(scores)
mu_hat = tau_hat/(N*M_bar)
sr2 = sum(n_stu^2*(y_bar - mu_hat)^2)
V_mu = (1-n/N)*sr2/(n*(n-1)*M_bar^2)
MOE = 2*sqrt(V_mu)
psu = 1:25
psi = c(0.000110, 0.018556, 0.062998, 0.078216, 0.075245,
0.073983, 0.076580, 0.038981, 0.040772, 0.022876,
0.003721, 0.024917, 0.040654, 0.014804, 0.005577,
0.070784, 0.069635, 0.034650, 0.069492, 0.036590,
0.033853, 0.016959, 0.009066, 0.021795, 0.059186)
sample(psu, 10, TRUE, psi)
psu = 1:25
psi = c(0.000110, 0.018556, 0.062998, 0.078216, 0.075245,
0.073983, 0.076580, 0.038981, 0.040772, 0.022876,
0.003721, 0.024917, 0.040654, 0.014804, 0.005577,
0.070784, 0.069635, 0.034650, 0.069492, 0.036590,
0.033853, 0.016959, 0.009066, 0.021795, 0.059186)
set.seed(123)
sample(psu, 10, TRUE, psi)
set.seed(123)
sample(psu, 10, TRUE)
