Sys.time()
knitr::opts_chunk$set(echo = TRUE)
dat = data.frame(
book_name = c(
"Bayesian Methods for Data Analysis",
"Bayesian Statistics: An Introduction, 4th Edition: An Introduction, 4th Edition",
"Bayesian Analysis of Gene Expression Data (Statistics in Practice)",
"Machine Learning for Decision Makers: Cognitive Computing Fundamentals for Better Decision Making",
"Interval-Censored Time-to-Event Data: Methods and Applications (Chapman & Hall/CRC Biostatistics Series)",
"Analysis of Metal-loss Corrosion on Energy Pipelines Based on ILI Data: A Bayesian Approach",
"Advanced Techniques in Knowledge Discovery and Data Mining (Advanced Information and Knowledge Processing)",
"Multiscale Modeling: A Bayesian Perspective (Springer Series in Statistics)",
"Dynamical Search: Applications of Dynamical Systems in Search and Optimization (Chapman & Hall/CRC Interdisciplinary Statistics)",
"Credit Risk Analytics: Measurement Techniques, Applications, and Examples in SAS (Wiley and SAS Business Series)"),
price = c(80.28, 52.11, 77.13, 29.99, 77.99, 84, 68.5, 44.99, 68.23, 23.14)
)
qt(0.025, 9)
?qt
qt(0.975, 9)
n = 10
t = qt(0.975, n - 1)
s = sd(dat$price)
xbar = mean(dat$price)
xbar - t*s/sqrt(n)
xbar + t*s/sqrt(n)
xbar
knitr::opts_chunk$set(echo = TRUE)
options(scipen=1, digits=2)
n = 10
t = qt(0.975, n - 1)
s = sd(dat$price)
xbar = mean(dat$price)
xbar - t*s/sqrt(n)
xbar + t*s/sqrt(n)
round(xbar - t*s/sqrt(n), 2)
xbar
s
t
options(scipen=3, digits=2)
n = 10
t = qt(0.975, n - 1)
s = sd(dat$price)
xbar = mean(dat$price)
xbar - t*s/sqrt(n)
xbar + t*s/sqrt(n)
t
s
xbar
knitr::opts_chunk$set(echo = TRUE)
max(c(9/4000, 9/300, (1/3000 - 1/300000000)))
variance = c(9/4000, 9/300, (1/3000 - 1/300000000))
variance = c(9/4000, 9/300, (1/3000 - 1/300000000))
which (variance == max(variance))
which (variance == min(variance))
knitr::opts_chunk$set(echo = TRUE)
qt(0.975, n - 1)
pacman::p_load(ggplot2)
ggplot(dat, aes(Diameter, Age)) + geom_point()
Diameter = c(12, 11.4, 7.9, 9, 10.5, 7.9, 7.3, 10.2, 11.7, 11.3,
5.7, 8.0, 10.3, 12, 9.2, 8.5, 7, 10.7, 9.3, 8.2)
Age = c(125, 119, 83, 85, 99, 117, 69, 133, 154, 168,
61, 80, 114, 147, 122, 106, 82, 88, 97, 99)
dat = data.frame(Diameter, Age)
pacman::p_load(ggplot2)
ggplot(dat, aes(Diameter, Age)) + geom_point()
ggplot(dat, aes(Diameter, Age)) +
geom_point() + geom_bw()
ggplot(dat, aes(Diameter, Age)) +
geom_point() + theme_bw()
shiny::runGitHub('jasonroy0/BNP-short-course/', username = 'jasonroy0', subdir = 'DP ShinyApp/DPMixApp/')
11.419*10.3
N = 1132
Bhat = mean(Age)/mean(Diameter)
residual = Age - Bhat*Diameter
SSE = sum(residual^2)/length(residual)
VhatB = (1-n/N)*SSE/(n*mean(Diameter)^2)
standard_error = sqrt(VhatB)
print(standard_error)
N = 1132
n = length(residual)
Bhat = mean(Age)/mean(Diameter)
residual = Age - Bhat*Diameter
SSE = sum(residual^2)/(n-1)
VhatB = (1-n/N)*SSE/(n*mean(Diameter)^2)
standard_error = sqrt(VhatB)
print(standard_error)
city = c(rep(1, 10), rep(2, 4), rep(3, 7),
rep(4, 8), rep(5, 2), rep(6, 3))
CaseNumber = c(
146, 180, 251, 152, 72, 181, 171, 361, 73, 186,
99, 101, 52, 121,
199, 179, 98, 63, 126, 87, 62,
226, 129, 57, 46, 86, 43, 85, 165,
12, 23,
87, 43, 59
)
dat3 = data.frame(city, CaseNumber)
ggplot(dat3, aes(city, CaseNumber)) + geom_boxplot()
ggplot(dat3, aes(group = city, CaseNumber)) + geom_boxplot()
ggplot(dat3, aes(group = city, y = CaseNumber)) + geom_boxplot()
width = 0.5,
fill = "#1F3552",
alpha = 0.5,
color = "#1F3552",
size = 0.9) +
theme_bw()
ggplot(dat3, aes(group = city, y = CaseNumber)) +
geom_boxplot() +
geom_violin(
width = 0.5,
fill = "#1F3552",
alpha = 0.5,
color = "#1F3552",
size = 0.9) +
theme_bw()
width = 0.5,
fill = "#1F3552",
alpha = 0.5,
color = "#1F3552",
size = 0.9) +
theme_bw()
ggplot(dat3, aes(x = "", y = CaseNumber, group = city)) +
geom_violin(width = 0.5, fill = "#1F3552", alpha = 0.5,
color = "#1F3552", size = 0.9) +
geom_boxplot() +  theme_bw()
ggplot(dat3, aes(x = "", y = CaseNumber, group = city)) +
geom_boxplot(color = "#1F3552", size = 0.9) +  theme_bw()
ggplot(dat3, aes(x = city, y = CaseNumber)) +
geom_boxplot(color = "#1F3552", size = 0.9) +  theme_bw()
ggplot(dat3, aes(y = CaseNumber, group = city)) +
geom_boxplot(color = "#1F3552", size = 0.9) +  theme_bw()
ggplot(dat3, aes(y = CaseNumber, group = factor(city))) +
geom_boxplot(color = "#1F3552", size = 0.9) +  theme_bw()
dat3 = data.frame(city, CaseNumber)
dat3$city = as.factor(dat3$city)
ggplot(dat3, aes(y = CaseNumber, group = city)) +
geom_boxplot(color = "#1F3552", size = 0.9) +  theme_bw()
mpg
ggplot(mpg, aes(class, hwy)) + geom_boxplot()
dat3 = data.frame(city, CaseNumber)
dat3$city = as.character(dat3$city)
ggplot(dat3, aes(city, CaseNumber)) +
geom_boxplot(color = "#1F3552", size = 0.9) +  theme_bw()
ggplot(dat3, aes(x = city, y = CaseNumber)) +
geom_boxplot(color = "#1F3552", size = 0.9) +  theme_bw()
pacman::p_load(tidyverse)
dat3 %>%
group_by(city) %>%
summarise(N = n(),
Mean = mean(CaseNumber),
Std_dev = sd(CaseNumber))
dat3 %>%
group_by(city) %>%
summarise(N = n(),
Mean = mean(CaseNumber),
Std_dev = sd(CaseNumber)) %>%
knitr::kable(., caption = 'Summary statistics for each cluster')
sum_tab = dat3 %>%
group_by(city) %>%
summarise(m_i = n(),
Mean = mean(CaseNumber),
Std_dev = sd(CaseNumber))
M_i = c(52, 19, 37, 39, 8, 14)
M = sum(M_i)
N = 45
n = nrow(sum_tab)
tau_hat = N/n*sum(M_i*sum_tab$Mean)
M_i*sum_tab$Mean
M_i
sum_tab$Mean
52 *177.3000
mu_hat = tau_hat/M
mu_hat
sum(M_i)/6*45
city = c(rep(1, 10), rep(2, 4), rep(3, 7),
rep(4, 8), rep(5, 2), rep(6, 3))
CaseNumber = c(
146, 180, 251, 152, 72, 181, 171, 361, 73, 186,
99, 101, 52, 121,
199, 179, 98, 63, 126, 87, 62,
226, 129, 57, 46, 86, 43, 85, 165,
12, 23,
87, 43, 59
)
dat3 = data.frame(city, CaseNumber)
dat3$city = as.character(dat3$city)
sum_tab = dat3 %>%
group_by(city) %>%
summarise(m_i = n(),
Mean = mean(CaseNumber),
Std_dev = sd(CaseNumber))
sum_tab
pacman::p_load(tidyverse)
pacman::p_load(tidyverse)
city = c(rep(1, 10), rep(2, 4), rep(3, 7),
rep(4, 8), rep(5, 2), rep(6, 3))
CaseNumber = c(
146, 180, 251, 152, 72, 181, 171, 361, 73, 186,
99, 101, 52, 121,
199, 179, 98, 63, 126, 87, 62,
226, 129, 57, 46, 86, 43, 85, 165,
12, 23,
87, 43, 59
)
dat3 = data.frame(city, CaseNumber)
dat3$city = as.character(dat3$city)
sum_tab = dat3 %>%
group_by(city) %>%
summarise(m_i = n(),
Mean = mean(CaseNumber),
Std_dev = sd(CaseNumber))
sum_tab
tau_hat = N/n*sum(M_i*y_bar)
M_i = c(52, 19, 37, 39, 8, 14)
M = sum(M_i)
N = 45
n = nrow(sum_tab)
M_hat = N/n*sum(M_i)
y_bar = sum_tab$Mean
tau_hat = N/n*sum(M_i*y_bar)
mu_hat = N/n*sum(M_i*y_bar)/M_hat
m_i = sum_tab$m_i
sum_tab = dat3 %>%
group_by(city) %>%
summarise(m_i = n(),
Mean = mean(CaseNumber),
Std_dev = sd(CaseNumber),
Sum = sum(CaseNumber))
M_i/m_i
sum_tab$Sum
M_i/m_i*sum_tab$Sum
373*4.75
5.2*1773
dat3
sum_tab
sum_tab %>%
select(city, Mean) %>%
right_join(dat3)
sum_tab %>%
select(city, Mean) %>%
right_join(dat3) %>%
mutate(diff_square = (CaseNumber - Mean)^2) %>%
group_by(city) %>%
summarise(sum_square = sum(diff_square))
sum_square = sum_tab %>%
select(city, Mean) %>%
right_join(dat3) %>%
mutate(diff_square = (CaseNumber - Mean)^2) %>%
group_by(city) %>%
summarise(sum_square = sum(diff_square)) %>%
pull(sum_square)
s_i_square = 1/(m_i - 1)*sum_square
s_i_square
m_i
y_bar
s_r_square = sum((M_i*y_bar - M_i*mu_hat)^2)
s_r_square
N/(M^2*n)*sum((1 - m_i/M_i)*M_i^2*s_i_square/m_i)
N^2/M^2(1 - n/N)*s_r_square/n
N^2/M^2*(1 - n/N)*s_r_square/n
N^2/M^2*(1 - n/N)*s_r_square/n +
N/(M^2*n)*sum((1 - m_i/M_i)*M_i^2*s_i_square/m_i)
sd_tau = sqrt(V_tau)
sd_tau
V_tau = N^2/M^2*(1 - n/N)*s_r_square/n +
N/(M^2*n)*sum((1 - m_i/M_i)*M_i^2*s_i_square/m_i)
sd_tau = sqrt(V_tau)
sd_tau
V_tau = N^2*(1 - n/N)*s_t_square/n + N/n*sum((1 - m_i/M_i)*M_i^2*s_i_square/m_i)
s_t_square = 1/(n - 1)*sum(tau_i - tau_hat/n)^2
tau_i = M_i/m_i*sum_tab$Sum
s_t_square = 1/(n - 1)*sum(tau_i - tau_hat/n)^2
sum_square = sum_tab %>%
select(city, Mean) %>%
right_join(dat3) %>%
mutate(diff_square = (CaseNumber - Mean)^2) %>%
group_by(city) %>%
summarise(sum_square = sum(diff_square)) %>%
pull(sum_square)
s_i_square = 1/(m_i - 1)*sum_square
V_tau = N^2*(1 - n/N)*s_t_square/n + N/n*sum((1 - m_i/M_i)*M_i^2*s_i_square/m_i)
sd_tau = sqrt(V_tau)
sd_tau
tau_hat
tau_i = M_i/m_i*sum_tab$Sum
s_t_square = 1/(n - 1)*sum(tau_i - tau_hat/n)^2
sum_square = sum_tab %>%
select(city, Mean) %>%
right_join(dat3) %>%
mutate(diff_square = (CaseNumber - Mean)^2) %>%
group_by(city) %>%
summarise(sum_square = sum(diff_square)) %>%
pull(sum_square)
s_i_square = 1/(m_i - 1)*sum_square
V_tau = N^2*(1 - n/N)*s_t_square/n + N/n*sum((1 - m_i/M_i)*M_i^2*s_i_square/m_i)
sd_tau = sqrt(V_tau)
# V_mu
s_r_square = sum((M_i*y_bar - M_i*mu_hat)^2)
V_mu = N^2/M^2*(1 - n/N)*s_r_square/n +
N/(M^2*n)*sum((1 - m_i/M_i)*M_i^2*s_i_square/m_i)
sd_mu = sqrt(V_tau)
knitr::opts_chunk$set(echo = TRUE, fig.align='center', fig.width=6, fig.asp=0.618,fig.pos = 'H')
knitr::kable(
sum_tab, align = 'center',
caption = 'Summary statistics for each cluster',
digits = 2)
city = c(rep(1, 10), rep(2, 4), rep(3, 7),
rep(4, 8), rep(5, 2), rep(6, 3))
CaseNumber = c(
146, 180, 251, 152, 72, 181, 171, 361, 73, 186,
99, 101, 52, 121,
199, 179, 98, 63, 126, 87, 62,
226, 129, 57, 46, 86, 43, 85, 165,
12, 23,
87, 43, 59
)
dat3 = data.frame(city, CaseNumber)
dat3$city = as.character(dat3$city)
sum_tab = dat3 %>%
group_by(city) %>%
summarise(m_i = n(),
Mean = mean(CaseNumber),
Std_dev = sd(CaseNumber),
Sum = sum(CaseNumber))
pacman:p_load(tidyverse)
pacman::p_load(tidyverse)
city = c(rep(1, 10), rep(2, 4), rep(3, 7),
rep(4, 8), rep(5, 2), rep(6, 3))
CaseNumber = c(
146, 180, 251, 152, 72, 181, 171, 361, 73, 186,
99, 101, 52, 121,
199, 179, 98, 63, 126, 87, 62,
226, 129, 57, 46, 86, 43, 85, 165,
12, 23,
87, 43, 59
)
dat3 = data.frame(city, CaseNumber)
dat3$city = as.character(dat3$city)
sum_tab = dat3 %>%
group_by(city) %>%
summarise(m_i = n(),
Mean = mean(CaseNumber),
Std_dev = sd(CaseNumber),
Sum = sum(CaseNumber))
M_i = c(52, 19, 37, 39, 8, 14)
m_i = sum_tab$m_i
M = sum(M_i)
N = 45
n = nrow(sum_tab)
M_hat = N/n*sum(M_i)
y_bar = sum_tab$Mean
tau_hat = N/n*sum(M_i*y_bar)
mu_hat = N/n*sum(M_i*y_bar)/M_hat
M_i = c(52, 19, 37, 39, 8, 14)
m_i = sum_tab$m_i
M = sum(M_i)
N = 45
n = nrow(sum_tab)
M_hat = N/n*sum(M_i)
y_bar = sum_tab$Mean
tau_hat = N/n*sum(M_i*y_bar)
mu_hat = N/n*sum(M_i*y_bar)/M_hat
M_hat
mean(M_i)
y_bar
n
tau_i = M_i/m_i*sum_tab$Sum
s_t_square = 1/(n - 1)*sum(tau_i - tau_hat/n)^2
s_t_square
tau_i = M_i/m_i*sum_tab$Sum
tau_i
tau_hat
s_t_square = 1/(n - 1)*sum((tau_i - tau_hat/N)^2)
s_t_square
tau_i = M_i/m_i*sum_tab$Sum
s_t_square = 1/(n - 1)*sum((tau_i - tau_hat/N)^2)
sum_square = sum_tab %>%
select(city, Mean) %>%
right_join(dat3) %>%
mutate(diff_square = (CaseNumber - Mean)^2) %>%
group_by(city) %>%
summarise(sum_square = sum(diff_square)) %>%
pull(sum_square)
s_i_square = 1/(m_i - 1)*sum_square
V_tau = N^2*(1 - n/N)*s_t_square/n + N/n*sum((1 - m_i/M_i)*M_i^2*s_i_square/m_i)
sd_tau = sqrt(V_tau)
# V_mu
s_r_square = sum((M_i*y_bar - M_i*mu_hat)^2)
V_mu = N^2/M^2*(1 - n/N)*s_r_square/n +
N/(M^2*n)*sum((1 - m_i/M_i)*M_i^2*s_i_square/m_i)
sd_mu = sqrt(V_mu)
sd_mu
tau_i = M_i/m_i*sum_tab$Sum
s_t_square = 1/(n - 1)*sum((tau_i - tau_hat/N)^2)
sum_square = sum_tab %>%
select(city, Mean) %>%
right_join(dat3) %>%
mutate(diff_square = (CaseNumber - Mean)^2) %>%
group_by(city) %>%
summarise(sum_square = sum(diff_square)) %>%
pull(sum_square)
s_i_square = 1/(m_i - 1)*sum_square
V_tau = N^2*(1 - n/N)*s_t_square/n + N/n*sum((1 - m_i/M_i)*M_i^2*s_i_square/m_i)
sd_tau = sqrt(V_tau)
# V_mu
s_r_square = sum((M_i*y_bar - M_i*mu_hat)^2)
V_mu = N^2/M^2*(1 - n/N)*s_r_square/n +
N/(M^2*n)*sum((1 - m_i/M_i)*M_i^2*s_i_square/m_i)
sd_mu = sqrt(V_mu)
sd_tau
s_i_square
# V_mu
s_r_square = sum((M_i*y_bar - M_i*mu_hat)^2)
s_r_square
M_hat
M
rm(list = ls())
pacman::p_load(tidyverse)
city = c(rep(1, 10), rep(2, 4), rep(3, 7),
rep(4, 8), rep(5, 2), rep(6, 3))
CaseNumber = c(
146, 180, 251, 152, 72, 181, 171, 361, 73, 186,
99, 101, 52, 121,
199, 179, 98, 63, 126, 87, 62,
226, 129, 57, 46, 86, 43, 85, 165,
12, 23,
87, 43, 59
)
dat3 = data.frame(city, CaseNumber)
dat3$city = as.character(dat3$city)
sum_tab = dat3 %>%
group_by(city) %>%
summarise(
m_i = n(),
Mean = mean(CaseNumber),
Std_dev = sd(CaseNumber),
Sum = sum(CaseNumber))
M_i = c(52, 19, 37, 39, 8, 14)
m_i = sum_tab$m_i
N = 45
n = nrow(sum_tab)
M_hat = N/n*sum(M_i)
y_bar = sum_tab$Mean
tau_hat = N/n*sum(M_i*y_bar)
mu_hat = N/n*sum(M_i*y_bar)/M_hat
tau_i = M_i/m_i*sum_tab$Sum
s_t_square = 1/(n - 1)*sum((tau_i - tau_hat/N)^2)
sum_square = sum_tab %>%
select(city, Mean) %>%
right_join(dat3) %>%
mutate(diff_square = (CaseNumber - Mean)^2) %>%
group_by(city) %>%
summarise(sum_square = sum(diff_square)) %>%
pull(sum_square)
s_i_square = 1/(m_i - 1)*sum_square
V_tau = N^2*(1 - n/N)*s_t_square/n + N/n*sum((1 - m_i/M_i)*M_i^2*s_i_square/m_i)
sd_tau = sqrt(V_tau)
# V_mu
s_r_square = sum((M_i*y_bar - M_i*mu_hat)^2)
V_mu = N^2/M_hat^2*(1 - n/N)*s_r_square/n +
N/(M^2*n)*sum((1 - m_i/M_i)*M_i^2*s_i_square/m_i)
V_mu = N^2/M_hat^2*(1 - n/N)*s_r_square/n +
N/(M_hat^2*n)*sum((1 - m_i/M_i)*M_i^2*s_i_square/m_i)
sd_mu = sqrt(V_mu)
V_mu
standard_error
N = 1132
n = length(Age)
Diameter = c(
12, 11.4, 7.9, 9, 10.5, 7.9, 7.3, 10.2, 11.7, 11.3,
5.7, 8.0, 10.3, 12, 9.2, 8.5, 7, 10.7, 9.3, 8.2)
Age = c(125, 119, 83, 85, 99, 117, 69, 133, 154, 168,
61, 80, 114, 147, 122, 106, 82, 88, 97, 99)
dat = data.frame(Diameter, Age)
N = 1132
n = length(Age)
tau_x = 10.3
Bhat = mean(Age)/mean(Diameter)
residual = Age - Bhat*Diameter
SSE = sum(residual^2)/(n-1)
VhatB = (1-n/N)*SSE*tau_x^2/(n*mean(Diameter)^2)
standard_error = sqrt(VhatB)
standard_error
